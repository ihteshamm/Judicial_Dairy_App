{"version":3,"sources":["../../src/ChatBot.tsx"],"names":["React","useEffect","useState","styles","icon","send","description","TextareaAutosize","MessageView","Options","moment","ChatBot","props","className","questions","lastMessage","onAnswer","initialMessages","idleTime","setIdleTime","keyValue","setKeyValue","currentQuestion","setCurrentQuestion","updateQuestionsWithAnswers","answer","val","identifier","value","map","each","answered","open","setOpen","setValue","chatList","setChatList","typing","setTyping","onChange","e","persist","target","selected","setSelected","onSelect","select","index","findIndex","filter","i","onSend","time","format","message","sender","answerType","split","validator","validatorCallBack","validatorCallback","setTimeout","onFinish","length","join","undefined","onEnter","charCode","shiftKey","unansweredQuestion","find","question","list","document","getElementById","scrollTop","scrollHeight","interval","setInterval","clearInterval","setRef","file","setFile","src","onSelectFile","fileSrc","onChangeFile","files","reader","FileReader","readAsDataURL","onloadend","result","chatBot","height","width","transition","chatBody","header","botLogo","display","fontWeight","marginTop","close","body","options","keepAlive","preview","includes","type","attachment","fileName","name","footer","input","uploader","element","click","flex","button"],"mappings":"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","sourcesContent":["import React, { ChangeEvent, FC, KeyboardEvent, useEffect, useState } from 'react';\nimport styles from './App.module.scss';\nimport icon from './assets/icon.svg';\nimport send from './assets/send.svg';\nimport description from './assets/description.svg';\nimport TextareaAutosize from 'react-textarea-autosize';\nimport MessageView, { Message } from './Message';\nimport Options from './Options';\nimport moment from 'dayjs';\n\nexport interface Props {\n  className?: string;\n  lastMessage: (value: any) => string;\n  questions: Question[];\n  onAnswer: (questions: Question[], value?: any) => void;\n  initialMessages?: Message[];\n}\n\nexport interface ValidatorObject {\n  message: (value: any) => string;\n  validatorCallback: (value: any) => boolean;\n}\n\nexport interface Question {\n  question: (value: any) => string;\n  answerType: 'paragraph' | 'input' | 'boolean' | 'select' | 'file' | 'number' | 'csv' | any;\n  identifier: string;\n  answer?: string | boolean | number | any;\n  answered?: boolean;\n  options?: string[];\n  fileSrc?: string;\n  validator?: ValidatorObject;\n}\n\nconst ChatBot: FC<Props> = (props) => {\n  const { className, questions, lastMessage, onAnswer, initialMessages = [] } = props;\n\n  const [idleTime, setIdleTime] = useState<number>(0);\n\n  const [keyValue, setKeyValue] = useState<any>({});\n\n  const [currentQuestion, setCurrentQuestion] = useState<Question>();\n\n  const updateQuestionsWithAnswers = (answer: any): void => {\n    const val = currentQuestion && { ...keyValue, [currentQuestion.identifier]: answer };\n    if (val) {\n      setKeyValue(val);\n    }\n\n    const value = questions.map((each) =>\n      each.identifier === currentQuestion?.identifier\n        ? {\n            ...each,\n            answered: true,\n            answer,\n          }\n        : each,\n    );\n    onAnswer(value, val);\n  };\n  const [open, setOpen] = useState<boolean>(true);\n  const [value, setValue] = useState<string>('');\n\n  const [chatList, setChatList] = useState<Message[]>(initialMessages);\n\n  const [typing, setTyping] = useState<boolean>(false);\n  const onChange = (e: any) => {\n    e.persist();\n    setValue(e.target.value);\n  };\n\n  const [selected, setSelected] = useState<string[]>([]);\n\n  const onSelect = (select: string) => {\n    const index = selected.findIndex((val: string) => val === select);\n    if (index !== -1) {\n      return setSelected((val) => val.filter((e, i) => i !== index));\n    }\n    setSelected((val) => [...val, select]);\n  };\n\n  const onSend = (): void => {\n    setIdleTime(0);\n    if (value) {\n      const time = moment().format();\n      setChatList((val) => [...val, { message: value, sender: 'user', time }]);\n      const answer = currentQuestion?.answerType === 'csv' ? value.split(',') : value;\n      if (currentQuestion?.validator) {\n        const validatorCallBack = currentQuestion?.validator?.validatorCallback;\n        if (validatorCallBack && !validatorCallBack(answer)) {\n          setTyping(true);\n          setTimeout(() => {\n            setChatList((val) => [\n              ...val,\n              { message: currentQuestion?.validator?.message(value) || '', sender: 'bot', time },\n            ]);\n            setTyping(false);\n          }, 1000);\n          return;\n        }\n      }\n      updateQuestionsWithAnswers(answer);\n      setValue('');\n      return;\n    }\n  };\n\n  const onFinish = () => {\n    setIdleTime(0);\n    const time = moment().format();\n    const message = !selected.length ? `My ${currentQuestion?.identifier} not listed` : ` - ${selected.join(`\\n - `)}`;\n\n    setChatList((val) => [...val, { message, sender: 'user', time }]);\n    if (currentQuestion?.validator) {\n      const validatorCallBack = currentQuestion?.validator?.validatorCallback;\n      if (validatorCallBack && !validatorCallBack(selected)) {\n        return setChatList((val) => [\n          ...val,\n          { message: currentQuestion?.validator?.message(selected) || '', sender: 'bot', time },\n        ]);\n      }\n    }\n    setCurrentQuestion(undefined);\n    updateQuestionsWithAnswers(selected);\n    setSelected([]);\n  };\n\n  const onEnter = (e: KeyboardEvent<HTMLInputElement | HTMLTextAreaElement>): void => {\n    if (e.charCode === 13 && value && !e.shiftKey) {\n      onSend();\n    }\n  };\n\n  useEffect(() => {\n    setTyping(true);\n    setTimeout(() => {\n      const time = moment().format();\n      const sender = 'bot';\n      const unansweredQuestion = questions.find((question) => !question.answered);\n      setCurrentQuestion(unansweredQuestion);\n      if (unansweredQuestion) {\n        const message = unansweredQuestion.question(keyValue);\n        setChatList((val) => [...val, { message, sender, time }]);\n      } else {\n        const message = lastMessage(keyValue);\n        setChatList((val) => [...val, { message, sender, time }]);\n      }\n      setTyping(false);\n    }, 1000);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [questions]);\n\n  useEffect(() => {\n    const list = document.getElementById('chat-list-body') as HTMLDivElement;\n    if (list) {\n      list.scrollTop = list.scrollHeight;\n    }\n  }, [chatList.length]);\n\n  useEffect(() => {\n    if (open) {\n      const interval = setInterval(() => {\n        setIdleTime((val) => val + 1);\n      }, 1000);\n      return () => {\n        clearInterval(interval);\n        setIdleTime(0);\n      };\n    }\n  }, [open]);\n\n  useEffect(() => {\n    if (idleTime >= 300) {\n      setOpen(false);\n    }\n  }, [idleTime, currentQuestion]);\n\n  const [, setRef] = useState<HTMLInputElement | null>(null);\n  const [file, setFile] = useState<{ src: any; file?: any }>({ src: '' });\n  const onSelectFile = () => {\n    const time = moment().format();\n    setChatList((val) => [...val, { message: value, fileSrc: file.src, sender: 'user', time, file: file.file }]);\n    updateQuestionsWithAnswers(file);\n    setFile((val) => ({ ...val, src: '' }));\n  };\n\n  const onChangeFile = (e: ChangeEvent<HTMLInputElement>) => {\n    const file: any = e.target.files && (e.target.files[0] as Blob);\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n    reader.onloadend = () => {\n      setFile({ file, src: reader.result });\n    };\n  };\n\n  return (\n    <span className={[styles.chatBot, className].join(' ')}>\n      <div\n        style={{ height: open ? 600 : 0, width: open ? 320 : 0, transition: `height ${open ? 800 : 0}ms ease-out` }}\n        className={styles.chatBody}\n      >\n        <div className={styles.header}>\n          <div className={styles.botLogo}>BOT</div>\n          <div className={styles.display}>\n            <div style={{ fontWeight: 'bold' }}>Chat Assistant</div>\n            <div style={{ marginTop: 4 }}>{typing ? 'typing...' : 'online'}</div>\n          </div>\n          <button onClick={() => setOpen(false)} aria-label=\"close\" className={styles.close}>\n            &times;\n          </button>\n        </div>\n        <div id=\"chat-list-body\" className={styles.body}>\n          {chatList.map((message: Message, index: number) => (\n            <MessageView key={index} {...message} />\n          ))}\n          {currentQuestion?.options && (\n            <Options onFinish={onFinish} options={currentQuestion.options} onSelect={onSelect} selected={selected} />\n          )}\n        </div>\n        {idleTime > 240 && (\n          <div\n            onClick={() => setIdleTime(0)}\n            className={styles.keepAlive}\n            role=\"button\"\n            aria-label=\"keep open\"\n          >{`Chat assistant will close in ${300 - idleTime} seconds. Click here to keep alive`}</div>\n        )}\n        {file.src && (\n          <div className={styles.preview}>\n            {['image/png', 'image/jpg'].includes(file.file.type) && <img alt=\"\" src={file.src} />}\n            {['video/mp4'].includes(file.file.type) && <video src={file.src} />}\n            {!['video/mp4', 'image/png', 'image/jpg'].includes(file?.file?.type || '') && (\n              <div className={styles.attachment}>\n                <img alt=\"\" src={description} />\n                <div className={styles.fileName}>{file?.file?.name}</div>\n              </div>\n            )}\n          </div>\n        )}\n        {currentQuestion && (\n          <div className={styles.footer}>\n            {['input', 'csv', 'number'].includes(currentQuestion.answerType) && (\n              <input\n                placeholder=\"Jot something down\"\n                onKeyPress={onEnter}\n                onChange={onChange}\n                value={value}\n                type={currentQuestion.answerType === 'number' ? 'number' : 'text'}\n                className={styles.input}\n              />\n            )}\n            {['paragraph'].includes(currentQuestion.answerType) && (\n              <TextareaAutosize\n                onKeyPress={onEnter}\n                placeholder=\"Jot something down\"\n                onChange={onChange}\n                value={value}\n                maxRows={6}\n                className={styles.input}\n              />\n            )}\n            {currentQuestion.answerType === 'file' && (\n              <div\n                className={styles.uploader}\n                role=\"button\"\n                onClick={() => {\n                  const element = document.getElementById('file-id') as HTMLInputElement;\n                  element && element.click();\n                }}\n                style={{ flex: 1 }}\n                id=\"file-upload-id\"\n              >\n                Upload a file\n                <input\n                  accept={'.pdf,.doc,.png,.jpg,.docx,.mp4,.mov'}\n                  ref={setRef}\n                  onChange={onChangeFile}\n                  style={{ display: 'none' }}\n                  id=\"file-id\"\n                  type=\"file\"\n                />\n              </div>\n            )}\n            {currentQuestion.answerType !== 'select' && (\n              <img\n                role=\"button\"\n                onClick={currentQuestion.answerType === 'file' ? onSelectFile : onSend}\n                className={styles.icon}\n                alt=\"\"\n                src={send}\n              />\n            )}\n          </div>\n        )}\n      </div>\n      {!open && (\n        <div\n          tabIndex={0}\n          data-testid=\"open\"\n          role=\"button\"\n          onClick={() => setOpen(true)}\n          aria-label=\"send message\"\n          className={styles.button}\n        >\n          <img alt=\"\" src={icon} />\n        </div>\n      )}\n    </span>\n  );\n};\n\nexport default ChatBot;\n"],"file":"ChatBot.js"}